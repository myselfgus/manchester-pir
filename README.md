# PIR - Protocol Intermediate Representation Compiler

[![Cloudflare Workers](https://img.shields.io/badge/Cloudflare-Workers-f38020?logo=cloudflare&logoColor=white)](https://workers.cloudflare.com/)
[![Cloudflare AI](https://img.shields.io/badge/Cloudflare-Workers_AI-f38020?logo=cloudflare&logoColor=white)](https://ai.cloudflare.com/)
[![Cloudflare for Startups](https://img.shields.io/badge/Cloudflare-for_Startups-f38020?logo=cloudflare&logoColor=white)](https://www.cloudflare.com/forstartups/)
[![MongoDB for Startups](https://img.shields.io/badge/MongoDB-for_Startups-47A248?logo=mongodb&logoColor=white)](https://www.mongodb.com/startups)
[![Tech AI Brasil](https://img.shields.io/badge/Tech_AI-Brasil-009739?logo=data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJMMiA3TDEyIDEyTDIyIDdMMTIgMloiIGZpbGw9IiNGRkRGMDAiLz4KPHBhdGggZD0iTTIgMTdMMTIgMjJMMjIgMTdNMiAxMkwxMiAxN0wyMiAxMiIgc3Ryb2tlPSIjRkZERjAwIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8L3N2Zz4K)](https://techbrasil.ai)
[![VOITHER](https://img.shields.io/badge/VOITHER-AI_Native_Healthcare-00a86b?logo=healthcare&logoColor=white)](https://voither.health)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.7-3178C6?logo=typescript&logoColor=white)](https://www.typescriptlang.org/)
[![FHIR R4](https://img.shields.io/badge/FHIR-R4-orange?logo=hl7&logoColor=white)](https://www.hl7.org/fhir/)
[![LGPD](https://img.shields.io/badge/LGPD-Compliant-green)](https://www.planalto.gov.br/ccivil_03/_ato2015-2018/2018/lei/l13709.htm)
[![Manchester Triage](https://img.shields.io/badge/Manchester-Triage_SP-blue)](https://www.prefeitura.sp.gov.br/cidade/secretarias/saude/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

Sistema AI-native para automaÃ§Ã£o de triagem clÃ­nica Manchester, transformando protocolos regulatÃ³rios em workflows executÃ¡veis na edge.

---

## ğŸ—ï¸ Arquitetura

PIR compila protocolos clÃ­nicos (Manchester Triage, Portaria SMS nÂº 82/2024) em **6 componentes executÃ¡veis** que rodam em **Cloudflare Workers AI**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          PROTOCOLO CLÃNICO                              â”‚
â”‚          Manchester Triage Protocol SP (Portaria SMS 82/2024)          â”‚
â”‚                                                                         â”‚
â”‚  52 Fluxogramas Ã— 5 Prioridades (Vermelho/Laranja/Amarelo/Verde/Azul)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚ PIR COMPILER â”‚
                      â”‚   (Claude)   â”‚
                      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         PIR JSON (Executable)                           â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ SLOTS   â”‚ â”‚ TASKS   â”‚ â”‚ GUARDS  â”‚ â”‚DEADLINES â”‚ â”‚ REWARDS â”‚        â”‚
â”‚  â”‚ (19)    â”‚ â”‚ (12)    â”‚ â”‚ (10)    â”‚ â”‚  (10)    â”‚ â”‚  (5)    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚           â”‚           â”‚            â”‚            â”‚              â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                              â”‚                                          â”‚
â”‚                              â–¼                                          â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
â”‚                      â”‚   EVIDENCE   â”‚                                  â”‚
â”‚                      â”‚   (FHIR +    â”‚                                  â”‚
â”‚                      â”‚    LGPD)     â”‚                                  â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLOUDFLARE WORKERS AI (Edge)                         â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚ pir-slots    â”‚  â”‚ pir-tasks    â”‚  â”‚ pir-guards   â”‚                â”‚
â”‚  â”‚ 19 LLMs      â”‚  â”‚ 12 LLMs      â”‚  â”‚ 10 LLMs      â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚pir-deadlines â”‚  â”‚ pir-rewards  â”‚  â”‚ pir-evidence â”‚                â”‚
â”‚  â”‚  Adaptive    â”‚  â”‚  RRE Learn   â”‚  â”‚  Audit Trail â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DISTRIBUTED HEALTHCARE SYSTEM                        â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚   ROE (Runtime       â”‚â—„â”€â”€â”€â”€â”€â”€â–ºâ”‚   RRE (Rhizomatic    â”‚            â”‚
â”‚  â”‚   Orchestrator)      â”‚        â”‚   Reasoning Engine)  â”‚            â”‚
â”‚  â”‚   Executa PIR        â”‚        â”‚   Aprende padrÃµes    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   RMS (Rhizomatic Memory System)                      â”‚             â”‚
â”‚  â”‚   MemÃ³ria distribuÃ­da, MongoDB Atlas                  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§  6 Componentes PIR

### 1. **SLOTS** - ExtraÃ§Ã£o Conversacional de Dados
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PIR-SLOTS (19 extractors)                  â”‚
â”‚                                                                 â”‚
â”‚  Audio (Whisper v3) â”€â”€â–º Transcript â”€â”€â–º 19 LLMs paralelos      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚  â”‚ Conversational   â”‚  â”‚ Device/Computed  â”‚                   â”‚
â”‚  â”‚ (8 slots)        â”‚  â”‚ (10 slots)       â”‚                   â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚                   â”‚
â”‚  â”‚ â€¢ chief_complaintâ”‚  â”‚ â€¢ systolic_bp    â”‚                   â”‚
â”‚  â”‚ â€¢ pain_score     â”‚  â”‚ â€¢ heart_rate     â”‚                   â”‚
â”‚  â”‚ â€¢ symptom_onset  â”‚  â”‚ â€¢ temperature    â”‚                   â”‚
â”‚  â”‚ â€¢ bleeding       â”‚  â”‚ â€¢ O2_saturation  â”‚                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                          â”‚
â”‚  â”‚ Historical (3)   â”‚                                          â”‚
â”‚  â”‚ â€¢ medical_hx     â”‚                                          â”‚
â”‚  â”‚ â€¢ medications    â”‚                                          â”‚
â”‚  â”‚ â€¢ allergies      â”‚                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚                                                                 â”‚
â”‚  Workers AI: Llama 3.1 8B, Whisper v3 Turbo, QWQ-32B          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**19 slots extraÃ­dos conversacionalmente** (sem formulÃ¡rios), processados em **paralelo mÃ¡ximo** (arquitetura rhizomatic).

---

### 2. **TASKS** - ExecuÃ§Ã£o Automatizada de Workflow
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PIR-TASKS (12 executors)                   â”‚
â”‚                                                                 â”‚
â”‚  Slot State â”€â”€â–º AI Planner â”€â”€â–º Parallel Waves â”€â”€â–º Outputs     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  WAVE 1 (Parallel)                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ [1] Initial Assessment  (QWQ-32B)               â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ [2] Flowchart Selection (DeepSeek-R1)           â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  WAVE 2 (Parallel)                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ [3] Apply General Discriminators   (QWQ-32B)    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ [4] Apply Specific Discriminators  (DeepSeek)   â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ [5] Priority Classification        (QWQ-32B)    â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  WAVE 3 (Conditional Priority Flows)                    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ [8]  Chest Pain Protocol    (DeepSeek-R1)       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ [9]  Stroke Protocol        (DeepSeek-R1)       â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ [10] Sepsis Bundle          (QWQ-32B)           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚ [11] Trauma ATLS            (DeepSeek-R1)       â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                 â”‚
â”‚  Workers AI: QWQ-32B, DeepSeek-R1, Llama 4 Scout              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**12 tasks automatizadas** executadas em **waves paralelas** determinadas por AI planner (QWQ-32B).

---

### 3. **GUARDS** - Barreiras Preditivas de SeguranÃ§a
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PIR-GUARDS (10 predictive)                   â”‚
â”‚                                                                 â”‚
â”‚  Slot + Task State â”€â”€â–º AI Selection â”€â”€â–º Parallel Guards       â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  CRITICAL PATTERN DETECTION                          â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚  â”‚ [1] Sepsis Early Detection    (QWQ-32B)      â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     qSOFA â‰¥2, SIRS â‰¥2 â†’ SUGGEST bundle       â”‚  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚     â”‚
â”‚  â”‚  â”‚ [2] Stroke Time Window        (DeepSeek-R1)  â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     <4.5h thrombolysis â†’ ALERT urgently      â”‚  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚     â”‚
â”‚  â”‚  â”‚ [3] Cardiac Ischemia Alert    (QWQ-32B)      â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     SCA pattern â†’ SUGGEST investigation      â”‚  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚     â”‚
â”‚  â”‚  â”‚ [4] Critical Hypoxemia        (QWQ-32B)      â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     SpO2 <85% â†’ ALERT immediate O2           â”‚  â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  MEDICATION SAFETY                                   â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚  â”‚ [6] Allergy Conflict Check    (QWQ-32B)      â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ [7] Medication Interaction    (DeepSeek-R1)  â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ [8] Pediatric Dose Safety     (QWQ-32B)      â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ [9] Geriatric Fragility       (QWQ-32B)      â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ [10] Pregnancy Contraindic.   (DeepSeek-R1)  â”‚  â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  Guards SUGGEST (nÃ£o bloqueiam) + Reasoning transparente      â”‚
â”‚  Workers AI: QWQ-32B, DeepSeek-R1                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**10 guards preditivos** que **sugerem** aÃ§Ãµes ANTES de problemas ocorrerem (nÃ£o bloqueiam reativamente).

---

### 4. **DEADLINES** - Janelas Temporais Adaptativas
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PIR-DEADLINES (10 adaptive)                    â”‚
â”‚                                                                 â”‚
â”‚  Context + Load â”€â”€â–º AI Assessment â”€â”€â–º Adaptive Deadlines      â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  MANCHESTER CLASSIFICATION DEADLINES                 â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚  â”‚ ğŸ”´ VERMELHO    Immediate    Never relaxes     â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ ğŸŸ  LARANJA     â‰¤10min       Relaxes to 15min  â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ ğŸŸ¡ AMARELO     â‰¤1h          Relaxes to 90min  â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ ğŸŸ¢ VERDE       â‰¤2h          Relaxes to 3h     â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ ğŸ”µ AZUL        â‰¤4h          Relaxes to 6h     â”‚  â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  PRIORITY FLOW DEADLINES (Never relax)               â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚  â”‚ Chest Pain ECG          â‰¤10min                â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ Stroke CT               â‰¤25min                â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ Stroke Thrombolysis     â‰¤60min                â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ Sepsis Antibiotic       â‰¤60min                â”‚  â”‚     â”‚
â”‚  â”‚  â”‚ Trauma Primary Survey   â‰¤2min                 â”‚  â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  AI-driven load assessment: Relaxa sob alta carga             â”‚
â”‚  Workers AI: QWQ-32B                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Deadlines adaptativos** que relaxam sob alta carga (mantÃ©m qualidade > velocidade) mas **nunca** em casos crÃ­ticos.

---

### 5. **REWARDS** - Sistema de Scoring para RRE
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PIR-REWARDS (5 categories)                   â”‚
â”‚                                                                 â”‚
â”‚  Session Outcome â”€â”€â–º 5 Calculators â”€â”€â–º Weighted Score â”€â”€â–º RRE â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  REWARD CATEGORIES (Weighted Sum)                    â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚  â”‚ [1] Classification Accuracy   35%  (QWQ-32B) â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     Triagem correta? Desfecho confirmou?     â”‚  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚     â”‚
â”‚  â”‚  â”‚ [2] Deadline Adherence        25%  (QWQ-32B) â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     Prazos cumpridos? Fluxos dentro janela?  â”‚  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚     â”‚
â”‚  â”‚  â”‚ [3] Patient Safety            30%  (QWQ-32B) â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     Eventos adversos? Guards funcionaram?    â”‚  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚     â”‚
â”‚  â”‚  â”‚ [4] Resource Efficiency        5%  (QWQ-32B) â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     Recursos usados apropriadamente?         â”‚  â”‚     â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚     â”‚
â”‚  â”‚  â”‚ [5] Pattern Detection          5%  (QWQ-32B) â”‚  â”‚     â”‚
â”‚  â”‚  â”‚     Sepse/AVC/IAM detectados precocemente?   â”‚  â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  Overall Score: -1 to +1 (normalized 0-100)                   â”‚
â”‚  Learning Signals: pattern_matches, optimal_actions           â”‚
â”‚  Anonymized features â†’ RRE para aprendizado                   â”‚
â”‚  Workers AI: QWQ-32B                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Score multidimensional** (5 categorias) que alimenta RRE para **aprendizado contÃ­nuo** do sistema.

---

### 6. **EVIDENCE** - Audit Trail FHIR + LGPD
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  PIR-EVIDENCE (3 collectors)                    â”‚
â”‚                                                                 â”‚
â”‚  Event â”€â”€â–º 3 Collectors Parallel â”€â”€â–º KV Storage + FHIR        â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  [1] PATIENT TIMELINE (Encrypted PHI)                â”‚     â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ AES-256-GCM encryption                   â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Consent-based collection (LGPD Art. 8)  â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ 5 year retention (LGPD Art. 16)         â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Auto-anonymization after 1 year         â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Patient rights (LGPD Art. 9):           â”‚  â”‚     â”‚
â”‚  â”‚      â”‚   - Access, Rectification, Deletion       â”‚  â”‚     â”‚
â”‚  â”‚      â”‚   - Portability, Revocation               â”‚  â”‚     â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  [2] SYSTEM AGGREGATE (De-identified, no PHI)        â”‚     â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ AI-driven anonymization (QWQ-32B)       â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ 24h aggregation windows                 â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Metrics: classifications, guards,       â”‚  â”‚     â”‚
â”‚  â”‚      â”‚   deadlines, patterns detected            â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Learning patterns â†’ RRE                 â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ No patient identifiers                  â”‚  â”‚     â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  [3] FHIR AUDIT (FHIR R4 AuditEvent)                 â”‚     â”‚
â”‚  â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ FHIR R4 compliant AuditEvent resources  â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Bundle support for batch export         â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Provenance tracking                     â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ External FHIR server export (optional)  â”‚  â”‚     â”‚
â”‚  â”‚      â”‚ â€¢ Regulatory compliance: ANS, CFM, LGPD   â”‚  â”‚     â”‚
â”‚  â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                                 â”‚
â”‚  Workers AI: QWQ-32B (anonymization), DeepSeek-R1 (patterns)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Trilha de auditoria completa**: timeline criptografado (PHI), agregados anonimizados (RRE learning), FHIR R4 (compliance).

---

## ğŸ”„ Fluxo Completo de Triagem

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PATIENT ARRIVES AT EMERGENCY                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 1: SLOT EXTRACTION (pir-slots)                                   â”‚
â”‚                                                                         â”‚
â”‚  Voice/Text â”€â”€â–º Whisper v3 â”€â”€â–º Transcript â”€â”€â–º 19 LLMs Parallel        â”‚
â”‚                                                                         â”‚
â”‚  Extracted:                                                             â”‚
â”‚  â€¢ Chief complaint: "dor torÃ¡cica hÃ¡ 2 horas"                          â”‚
â”‚  â€¢ Pain score: 8/10                                                    â”‚
â”‚  â€¢ Vital signs: BP 145/90, HR 95, SpO2 96%, Temp 36.8Â°C              â”‚
â”‚  â€¢ Associated symptoms: sudorese, nÃ¡usea                               â”‚
â”‚                                                                         â”‚
â”‚  â±ï¸  ~5-8 seconds (parallel extraction)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 2: TASK EXECUTION (pir-tasks)                                    â”‚
â”‚                                                                         â”‚
â”‚  Slot State â”€â”€â–º AI Planner â”€â”€â–º Parallel Waves                         â”‚
â”‚                                                                         â”‚
â”‚  WAVE 1:                                                                â”‚
â”‚  [1] Initial Assessment  â†’ "Suspeita de SCA, prioridade alta"         â”‚
â”‚  [2] Flowchart Selection â†’ "Fluxograma: dor_toracica"                 â”‚
â”‚                                                                         â”‚
â”‚  WAVE 2:                                                                â”‚
â”‚  [3] General Discriminators  â†’ "Dor opressiva, sudorese = LARANJA"    â”‚
â”‚  [4] Specific Discriminators â†’ "Fatores de risco cardÃ­aco presentes"  â”‚
â”‚  [5] Priority Classification â†’ "LARANJA (muito urgente, â‰¤10min)"      â”‚
â”‚                                                                         â”‚
â”‚  WAVE 3 (Conditional):                                                  â”‚
â”‚  [8] Chest Pain Priority Flow ACTIVATED                                â”‚
â”‚      â€¢ ECG em â‰¤10min                                                   â”‚
â”‚      â€¢ Troponina solicitada                                            â”‚
â”‚      â€¢ AAS 300mg + Clopidogrel 300mg prescritos                        â”‚
â”‚                                                                         â”‚
â”‚  â±ï¸  ~3-5 seconds (parallel waves)                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 3: GUARD EVALUATION (pir-guards)                                 â”‚
â”‚                                                                         â”‚
â”‚  Slots + Tasks â”€â”€â–º AI Selection â”€â”€â–º Relevant Guards Parallel          â”‚
â”‚                                                                         â”‚
â”‚  Selected guards:                                                       â”‚
â”‚  âœ“ [3] Cardiac Ischemia Alert                                         â”‚
â”‚      TRIGGERED: "PadrÃ£o de SCA detectado. ECG urgente."               â”‚
â”‚      Priority: CRITICAL, Override: allowed                             â”‚
â”‚                                                                         â”‚
â”‚  âœ“ [6] Allergy Conflict Check                                         â”‚
â”‚      NOT TRIGGERED: "Sem conflitos alÃ©rgicos com AAS/Clopidogrel"     â”‚
â”‚                                                                         â”‚
â”‚  âœ“ [7] Medication Interaction                                          â”‚
â”‚      NOT TRIGGERED: "Sem interaÃ§Ãµes significativas"                    â”‚
â”‚                                                                         â”‚
â”‚  â±ï¸  ~2-3 seconds (parallel guards)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 4: DEADLINE MONITORING (pir-deadlines)                           â”‚
â”‚                                                                         â”‚
â”‚  Context + Load â”€â”€â–º AI Assessment â”€â”€â–º Active Deadlines                â”‚
â”‚                                                                         â”‚
â”‚  Deadlines tracked:                                                     â”‚
â”‚  â€¢ Initial Assessment LARANJA: â‰¤10min (relaxes to 15min if load high) â”‚
â”‚  â€¢ Chest Pain ECG: â‰¤10min (NEVER relaxes)                             â”‚
â”‚                                                                         â”‚
â”‚  Status: Both deadlines ACTIVE, queue length: 12 patients             â”‚
â”‚  Load condition: NORMAL â†’ No relaxation needed                         â”‚
â”‚                                                                         â”‚
â”‚  â±ï¸  Continuous monitoring                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 5: EVIDENCE COLLECTION (pir-evidence)                            â”‚
â”‚                                                                         â”‚
â”‚  All Events â”€â”€â–º 3 Collectors Parallel â”€â”€â–º Storage                     â”‚
â”‚                                                                         â”‚
â”‚  âœ“ Patient Timeline (encrypted)                                        â”‚
â”‚    â€¢ All events stored with AES-256-GCM                                â”‚
â”‚    â€¢ Consent validated (LGPD compliant)                                â”‚
â”‚                                                                         â”‚
â”‚  âœ“ System Aggregate (anonymized)                                       â”‚
â”‚    â€¢ Dor torÃ¡cica pattern +1                                           â”‚
â”‚    â€¢ Cardiac ischemia guard triggered +1                               â”‚
â”‚    â€¢ Laranja classification +1                                         â”‚
â”‚                                                                         â”‚
â”‚  âœ“ FHIR Audit (FHIR R4)                                               â”‚
â”‚    â€¢ AuditEvent resources created                                      â”‚
â”‚    â€¢ Ready for external FHIR server export                             â”‚
â”‚                                                                         â”‚
â”‚  â±ï¸  ~1-2 seconds (parallel collection)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ OUTCOME: ECG performed at 8min â†’ STEMI confirmed                       â”‚
â”‚          Patient transferred to cath lab                                â”‚
â”‚          Door-to-balloon time: 72 minutes                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PHASE 6: REWARD CALCULATION (pir-rewards)                              â”‚
â”‚                                                                         â”‚
â”‚  Outcome Data â”€â”€â–º 5 Calculators â”€â”€â–º Weighted Score â”€â”€â–º RRE            â”‚
â”‚                                                                         â”‚
â”‚  Category Scores:                                                       â”‚
â”‚  â€¢ Classification Accuracy: 1.0 (correct LARANJA â†’ STEMI)             â”‚
â”‚  â€¢ Deadline Adherence: 1.0 (ECG 8min, both deadlines met)             â”‚
â”‚  â€¢ Patient Safety: 1.0 (no adverse events, guard worked)               â”‚
â”‚  â€¢ Resource Efficiency: 0.9 (appropriate exams/meds)                   â”‚
â”‚  â€¢ Pattern Detection: 1.0 (cardiac ischemia detected early)            â”‚
â”‚                                                                         â”‚
â”‚  Overall Score: 0.985 (98.5/100) â†’ EXCELLENT outcome                   â”‚
â”‚                                                                         â”‚
â”‚  Learning Signals â†’ RRE:                                                â”‚
â”‚  â€¢ Pattern: "chest_pain + diaphoresis + nausea â†’ high_risk_SCA"       â”‚
â”‚  â€¢ Optimal action: "activate_chest_pain_flow_immediately"              â”‚
â”‚  â€¢ Reinforce: "cardiac_ischemia_guard" detection accuracy              â”‚
â”‚                                                                         â”‚
â”‚  â±ï¸  ~2-3 seconds (parallel calculators)                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

TOTAL TRIAGE TIME: ~15-20 seconds (all phases combined)
```

---

## ğŸš€ Tech Stack

| Component | Technology | Purpose |
|-----------|-----------|---------|
| **Runtime** | Cloudflare Workers | Edge compute (Brasil: SÃ£o Paulo, Rio, BrasÃ­lia) |
| **AI/ML** | Cloudflare Workers AI | GPU inference on-edge (QWQ-32B, DeepSeek-R1, Llama 3.1) |
| **Storage** | Cloudflare KV | Evidence storage (encrypted timelines, aggregates) |
| **Database** | MongoDB Atlas | Distributed memory (RMS) |
| **STT** | Whisper v3 Turbo | Speech-to-text (2-4x faster than v2) |
| **Language** | TypeScript 5.7 | Type-safe, strict mode |
| **Compliance** | FHIR R4 + LGPD | Healthcare interoperability + data protection |
| **Protocol** | Manchester Triage SP | Portaria SMS nÂº 82/2024 (SÃ£o Paulo) |

---

## ğŸ“Š Performance Metrics

| Metric | Target | Actual |
|--------|--------|--------|
| **Slot Extraction** | <10s | ~5-8s (19 parallel) |
| **Task Execution** | <5s | ~3-5s (waves) |
| **Guard Evaluation** | <3s | ~2-3s (parallel) |
| **Total Triage Time** | <20s | ~15-20s |
| **Classification Accuracy** | >85% | 88% (real data) |
| **Deadline Adherence** | >80% | 84.9% (real data) |
| **Patient Safety Score** | >0.9 | 0.92 (real data) |

---

## ğŸ¥ Manchester Triage Protocol SP

PIR implementa **Portaria SMS nÂº 82/2024** (Protocolo de ClassificaÃ§Ã£o de Risco Manchester para SÃ£o Paulo):

### 5 Prioridades

| Cor | Prioridade | Tempo Alvo | CritÃ©rios |
|-----|-----------|-----------|----------|
| ğŸ”´ **VERMELHO** | EmergÃªncia | Imediato | Risco iminente de morte |
| ğŸŸ  **LARANJA** | Muito Urgente | â‰¤10 min | Risco alto, necessita atenÃ§Ã£o rÃ¡pida |
| ğŸŸ¡ **AMARELO** | Urgente | â‰¤1 hora | Risco presente, pode aguardar |
| ğŸŸ¢ **VERDE** | Pouco Urgente | â‰¤2 horas | CondiÃ§Ãµes estÃ¡veis |
| ğŸ”µ **AZUL** | NÃ£o Urgente | â‰¤4 horas | Atendimento eletivo |

### 52 Fluxogramas Implementados

- Dor torÃ¡cica
- Dispneia (adulto/crianÃ§a)
- Cefaleia
- Dor abdominal
- Trauma
- Hemorragias
- AlteraÃ§Ãµes de consciÃªncia
- ConvulsÃµes
- ... e mais 44 fluxogramas

### 4 Fluxos PrioritÃ¡rios

1. **Dor TorÃ¡cica** â†’ Protocolo IAM (ECG â‰¤10min, Door-to-balloon â‰¤90min)
2. **AVC** â†’ Protocolo stroke (CT â‰¤25min, TrombÃ³lise â‰¤60min)
3. **Sepse** â†’ Bundle 1 hora (antibiÃ³tico â‰¤60min)
4. **Trauma** â†’ ATLS (avaliaÃ§Ã£o primÃ¡ria â‰¤2min)

---

## ğŸ§ª Workers AI Models Used

| Model | Use Case | Workers |
|-------|----------|---------|
| **QWQ-32B** (`@cf/qwen/qwq-32b-preview`) | Clinical reasoning, complex decisions | tasks, guards, deadlines, rewards, evidence |
| **DeepSeek-R1** (`@cf/deepseek/deepseek-r1-distill-qwen-32b`) | Advanced reasoning, critical analysis | tasks, guards, deadlines, rewards, evidence |
| **Llama 3.1 8B** (`@cf/meta/llama-3.1-8b-instruct`) | Fast conversational extraction | slots |
| **Llama 4 Scout 17B** (`@cf/meta/llama-4-scout-17b-16e-instruct`) | Multimodal MoE (2025) | tasks, guards |
| **Whisper v3 Turbo** (`@cf/openai/whisper-large-v3-turbo`) | Speech-to-text (2-4x faster) | slots |

**Total**: 5 state-of-the-art models, **82 LLM calls per triage session** (all parallel).

---

## ğŸ“ Project Structure

```
pir/
â”œâ”€â”€ workers/
â”‚   â”œâ”€â”€ pir-slots/          # 19 conversational extractors
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ slots.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ extractors/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base-extractor.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ conversational-slots.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ device-computed-slots.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ historical-slots.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ rhizomatic-orchestrator.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ stt/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ whisper-worker.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ pir-tasks/          # 12 automated executors
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ tasks.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ executors/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base-executor.ts
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ llm-tasks.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ operational-tasks.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ task-orchestrator.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ pir-guards/         # 10 predictive guards
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ guards.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ executors/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base-guard.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ llm-guards.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ guard-orchestrator.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ pir-deadlines/      # Adaptive time windows
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ deadlines.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ evaluators/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base-evaluator.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ deadline-evaluators.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ deadline-orchestrator.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â”œâ”€â”€ pir-rewards/        # RRE scoring system
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ rewards.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ calculators/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ base-calculator.ts
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ reward-calculators.ts
â”‚   â”‚   â”‚   â”œâ”€â”€ orchestrator/
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ reward-orchestrator.ts
â”‚   â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”‚   â””â”€â”€ README.md
â”‚   â”‚
â”‚   â””â”€â”€ pir-evidence/       # FHIR + LGPD audit trail
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ types/
â”‚       â”‚   â”‚   â””â”€â”€ evidence.ts
â”‚       â”‚   â”œâ”€â”€ collectors/
â”‚       â”‚   â”‚   â”œâ”€â”€ base-collector.ts
â”‚       â”‚   â”‚   â””â”€â”€ fhir-collector.ts
â”‚       â”‚   â”œâ”€â”€ orchestrator/
â”‚       â”‚   â”‚   â””â”€â”€ evidence-orchestrator.ts
â”‚       â”‚   â””â”€â”€ index.ts
â”‚       â””â”€â”€ README.md
â”‚
â”œâ”€â”€ manchester-sp-protocol.pir.json   # Reference PIR implementation
â”œâ”€â”€ prompt-pir-compiler.md            # PIR Compiler specification
â”œâ”€â”€ voither-conversation-knowledge.md # Architecture knowledge base
â”œâ”€â”€ CLAUDE.md                         # Development guidelines
â””â”€â”€ README.md                         # This file
```

---

## ğŸ› ï¸ Development

### Prerequisites

```bash
node >= 20.0.0
npm >= 10.0.0
wrangler >= 3.94.0
```

### Install Dependencies

```bash
cd workers/pir-{component}
npm install
```

### Local Development

```bash
npx wrangler dev
```

### Deploy to Cloudflare

```bash
npx wrangler deploy
```

### Environment Variables

```bash
# Required for all workers
CLOUDFLARE_ACCOUNT_ID=your_account_id

# Optional: External FHIR server (pir-evidence)
FHIR_AUDIT_ENDPOINT=https://your-fhir-server.com/AuditEvent
```

---

## ğŸ” Compliance

### LGPD (Lei 13.709/2018)

- âœ… **Article 8**: Explicit consent tracking
- âœ… **Article 9**: Patient rights (access, rectification, deletion, portability, revocation)
- âœ… **Article 12**: Anonymization of aggregated data
- âœ… **Article 16**: 5-year retention, auto-anonymization after 1 year
- âœ… **Article 37**: Access logs for all data operations
- âœ… **Article 46**: AES-256-GCM encryption for PHI

### FHIR R4 (HL7)

- âœ… **AuditEvent** resources for all operations
- âœ… **Bundle** support for batch exports
- âœ… **Provenance** tracking for data lineage
- âœ… **Patient** resource compatibility

### ANS & CFM

- âœ… Audit trail compliant
- âœ… Medical records retention
- âœ… ProntuÃ¡rio eletrÃ´nico standards

---

## ğŸ“š Documentation

- [PIR Compiler Specification](prompt-pir-compiler.md)
- [VOITHER Architecture](voither-conversation-knowledge.md)
- [Development Guidelines](CLAUDE.md)
- Individual worker READMEs:
  - [pir-slots](workers/pir-slots/README.md)
  - [pir-tasks](workers/pir-tasks/README.md)
  - [pir-guards](workers/pir-guards/README.md)
  - [pir-deadlines](workers/pir-deadlines/README.md)
  - [pir-rewards](workers/pir-rewards/README.md)
  - [pir-evidence](workers/pir-evidence/README.md)

---

## ğŸ¤ Contributing

PIR Ã© um projeto open-source. ContribuiÃ§Ãµes sÃ£o bem-vindas!

1. Fork o repositÃ³rio
2. Crie uma branch (`git checkout -b feature/nova-funcionalidade`)
3. Commit suas mudanÃ§as (`git commit -am 'Adiciona nova funcionalidade'`)
4. Push para a branch (`git push origin feature/nova-funcionalidade`)
5. Abra um Pull Request

---

## ğŸ“„ License

MIT License - veja [LICENSE](LICENSE) para detalhes.

---

## ğŸ¢ About VOITHER

**VOITHER** Ã© uma tech AI brasileira construindo a prÃ³xima geraÃ§Ã£o de sistemas de saÃºde pÃºblica com arquitetura AI-native, rhizomatic e local-first.

**Supported by:**
- [Cloudflare for Startups](https://www.cloudflare.com/forstartups/)
- [MongoDB for Startups](https://www.mongodb.com/startups)

---

## ğŸ“ Contact

- **Website**: [voither.health](https://voither.health)
- **Email**: dev@voither.health
- **GitHub**: [github.com/voither/pir](https://github.com/voither/pir)

---

<p align="center">
  <strong>Built with â¤ï¸ in Brasil</strong><br>
  <sub>Automating public healthcare, one protocol at a time.</sub>
</p>
